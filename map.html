<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>深色地图</title>
<style>
html, body, #container {
  width: 100%;
  height: 100%;
  margin: 0;
  padding: 0;
}
</style>

<!-- 腾讯地图 JS API v2 -->
<script>
function loadMapApi() {
  const script = document.createElement('script');
  script.src = "https://map.qq.com/api/js?v=2.exp&key=OB4BZ-D4W3U-B7VVO-4PJWW-6TKDJ-WPB77&callback=initMap";
  script.async = true;
  document.body.appendChild(script);
}
</script>
</head>
<body>
<div id="container"></div>

<script>
let map = null;

// H5传参解析
const params = new URLSearchParams(location.search);
const path = JSON.parse(decodeURIComponent(params.get('path')));

// 初始化地图回调
function initMap() {
  // 创建地图，关闭所有控件
  map = new qq.maps.Map(document.getElementById("container"), {
    center: new qq.maps.LatLng(path[0].lat, path[0].lng),
    zoom: 5,
    mapTypeId: qq.maps.MapTypeId.ROADMAP,
    mapStyleId: 'style2',      // 官方暗色样式
    zoomControl: false,        // 关闭缩放按钮
    scaleControl: false,       // 关闭比例尺
    mapTypeControl: false,     // 关闭卫星切换
    panControl: false,         // 关闭平移控件
    draggable: true,
    scrollwheel: true
  });

  // 绘制城市点
  path.forEach(p => {
    new qq.maps.Marker({
      position: new qq.maps.LatLng(p.lat, p.lng),
      map: map,
      title: p.city
    });
  });
}

// 开始加载地图API
loadMapApi();
</script>
</body>
</html>
